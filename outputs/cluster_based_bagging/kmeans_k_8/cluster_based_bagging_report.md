# Cluster-Based Bagging (K=8)

Отчёт о сравнении sklearn и custom Bagging на явных и неясных кластерах.

## Стратегия

- **Обучающая выборка**: кластеры, где преобладает один класс (фишинг >80% или <20%)
- **Тестовая выборка**: кластеры с "неясной" композицией (20%-80% фишинга)
- **Явные кластеры**: [0, 1, 2, 4, 7]
- **Неясные кластеры**: [3, 5, 6]
- **Размер обучающей выборки**: 7096
- **Размер тестовой выборки**: 3959

## Результаты: Логистическая регрессия

| Реализация | Accuracy | Precision | Recall | F1 | ROC-AUC |
|---|---:|---:|---:|---:|---:|
| sklearn Bagging | 0.9270 | 0.9560 | 0.9453 | 0.9506 | 0.9741 |
| Custom Bagging | 0.9265 | 0.9531 | 0.9476 | 0.9504 | 0.9721 |

## Результаты: Дерево решений

| Реализация | Accuracy | Precision | Recall | F1 | ROC-AUC |
|---|---:|---:|---:|---:|---:|
| sklearn Bagging | 0.9124 | 0.9250 | 0.9599 | 0.9421 | 0.9611 |
| Custom Bagging | 0.8982 | 0.9216 | 0.9432 | 0.9323 | 0.9605 |

## Анализ

Модель была обучена на "явных" кластерах и протестирована на "неясных" кластерах.
Это проверяет, насколько хорошо модель может классифицировать примеры на границе между фишингом и не-фишингом.

## Сохранённые файлы

- `bagging_metrics_lr.png` — сравнение метрик для логистической регрессии
- `bagging_metrics_dt.png` — сравнение метрик для дерева решений
- `cluster_based_bagging_report.md` — этот файл
